<script>
  let count = 0;
  let target = 0;

  function setDefaultPlan() {
    target = 100;                 // default SubhanAllah 33 + Alhamdulillah 33 + Allahu Akbar 34
    showCounterArea();
    update();
  }

  function setCustomPlan() {
    const val = parseInt(document.getElementById('customTarget').value, 10);
    if (Number.isFinite(val) && val > 0) {
      target = val;
      showCounterArea();
      update();
    } else {
      alert('Please enter a valid number!');
    }
  }

  function showCounterArea() {
    const setup = document.getElementById('setup');
    const area  = document.getElementById('counter-area');
    if (setup) setup.style.display = 'none';
    if (area)  area.style.display  = 'block';
  }

  function increment() {
    if (!target) {
      alert('Please choose a plan first.');
      return;
    }
    if (count < target) {
      count++;
      update();
      if (count === target) celebrate();
    }
  }

  function update() {
    const counterEl  = document.getElementById('counter');
    const progressEl = document.getElementById('progress');
    if (counterEl)  counterEl.textContent = count;
    if (progressEl) {
      const percent = target ? (count / target) * 100 : 0;
      progressEl.style.width = percent + '%';
    }
  }

  function celebrate() {
    const popup = document.getElementById('popup');
    if (popup) popup.style.display = 'flex';
    for (let i = 0; i < 25; i++) createBalloon();
  }

  function createBalloon() {
    const b = document.createElement('div');
    b.className = 'balloon';
    b.style.left = Math.random() * 100 + 'vw';
    b.style.backgroundColor = randomColor();
    b.style.transform = `scale(${0.7 + Math.random() * 0.8})`;
    b.style.animationDuration = (5 + Math.random() * 3) + 's';
    document.body.appendChild(b);
    setTimeout(() => b.remove(), 9000);
  }

  function randomColor() {
    const colors = ['#f44336','#e91e63','#9c27b0','#3f51b5','#2196f3','#009688','#4caf50','#ff9800','#795548'];
    return colors[Math.floor(Math.random() * colors.length)];
  }

  function restart() {
    count = 0;
    update();
    const popup = document.getElementById('popup');
    if (popup) popup.style.display = 'none';
  }

  // initialize progress width on first load
  document.addEventListener('DOMContentLoaded', update);
</script>
